var app=angular.module("app",["ngRoute","ngCookies","home","ui.grid","ui.grid.grouping","ui.grid.selection","ui.grid.resizeColumns","ui.grid.expandable","ui.grid.cellNav","ui.grid.edit","ui.grid.infiniteScroll","ui.grid.exporter","ngFileUpload","chart.js"]);app.config(["$provide","$routeProvider","$httpProvider","$logProvider",function(n,t,i,r){r.debugEnabled(!0);n.decorator("$templateRequest",["$delegate",function(n){return function(t){return n(t,!0)}}]);i.interceptors.push(["$q","$location",function(n,t){return{responseError:function(i){return i.status===401&&t.url("/signin"),n.reject(i)}}}]);t.when("/home",{templateUrl:"App/Home",controller:"homeCtrl"});t.when("/background",{templateUrl:"App/Background",controller:"backgroundCtrl"});t.when("/contact",{templateUrl:"App/Contact",controller:"contactCtrl"});t.when("/dashboard",{templateUrl:"Dashboard/Index",controller:"dashboardCtrl"});t.when("/rip",{templateUrl:"RIP/RIPSequenceView",controller:"ripCtrl"});t.when("/rip/lrar/sequence/:FileName/:SequenceName",{templateUrl:"RIP/LRARView",controller:"lrarCtrl"});t.when("/rip/lrar/file/:FileName",{templateUrl:"RIP/LRARView",controller:"lrarCtrl"});t.when("/rip/sequence/:FileName/:SequenceName",{templateUrl:"RIP/RIPSequenceView",controller:"ripCtrl"});t.when("/rip/file/:FileName",{templateUrl:"RIP/RIPSequenceView",controller:"ripCtrl"});t.when("/rip/profile/file/:FileName",{templateUrl:"RIP/RIPProfileView",controller:"ripProfileCtrl"});t.when("/files",{templateUrl:"Files/Files",controller:"filesCtrl"});t.when("/sequences/:FileName",{templateUrl:"Sequence/Sequences",controller:"sequenceCtrl"});t.otherwise({redirectTo:"/home"})}]);app.run(["$http","$cookies","$cookieStore",function(n,t,i){n.defaults.headers.common.Authorization="Bearer "+i.get("_Token")}]);app.run(["$rootScope","$http","$cookies","$cookieStore",function(){}]),function(){"use strict";function n(n){function t(){}n.title="backgroundCtrl";t()}angular.module("app").controller("backgroundCtrl",n);n.$inject=["$scope"]}(),function(){"use strict";function n(n){function t(){}n.title="contactCtrl";t()}angular.module("app").controller("contactCtrl",n);n.$inject=["$scope"]}(),function(){"use strict";function n(n,t,i){function r(){i.list().then(t=>{n.files=t,n.loadingFiles=!1})}n.title="filesCtrl";n.loadingFiles=!0;r();n.submit=function(){n.form.file.$valid&&n.file&&n.upload(n.file)};n.upload=function(){var i;n.uploadingFile=!0;var e=$("#fileup").get(0),u=e.files,f=new FormData;for(i=0;i<u.length;i++)f.append(u[i].name,u[i]);t.post("/api/files/upload",f,{headers:{"Content-Type":undefined},transformRequest:angular.identity}).success(function(){r();n.uploadingFile=!1}).error(function(){n.uploadingFile=!1;alert("Something went wrong!")})}}angular.module("app").controller("filesCtrl",n);n.$inject=["$scope","$http","fileFactory"]}();angular.module("home",[]).controller("homeCtrl",["$scope","$http",function(){}]),function(){"use strict";function n(n,t,i,r){function u(){n.lrarLoading=!0;n.SequenceName=t.SequenceName;n.FileName=t.FileName;n.SequenceName!==undefined?(n.type="s",i.getSequence(n.FileName,n.SequenceName,n.window,n.slide,n.compositeRequirement,n.productRequirement,n.substrateRequirement,n.compositeCountRequirement,n.checkGcContent).then(function(t){n.lrarGridOptions.data=t;f();n.lrarLoading=!1})):n.FileName!==undefined&&(n.type="f",i.getFile(n.FileName,n.window,n.slide,n.compositeRequirement,n.productRequirement,n.substrateRequirement,n.compositeCountRequirement,n.checkGcContent).then(function(t){n.lrarGridOptions.data=t;f();n.lrarLoading=!1}))}function e(){let i=n.lrarGridOptions.data,r=i.map(n=>n.Name),u=[...new Set(r)],t=[];u.forEach(n=>{let r=i.filter(t=>t.Name===n),u=r.map(n=>n.Size),f=u.reduce(function(n,t){return n+t},0);t.push({Name:n,Size:f})});n.sequenceSize.data=t.map(n=>n.Size);n.sequenceSize.labels=t.map(n=>n.Name.slice(0,12))}function f(){e();n.chartSize.labels=n.lrarGridOptions.data.map(function(n){return n.Start+"-"+n.End});n.chartSize.data=n.lrarGridOptions.data.map(function(n){return n.Size})}n.title="lrarCtrl";n.lrarLoading=!0;n.chartSize={};n.sequenceSize={};n.window=1e3;n.slide=500;n.compositeRequirement=.01;n.productRequirement=1.1;n.substrateRequirement=.75;n.compositeCountRequirement=7;u();n.lrarGridOptions={multiSelect:!1,showGridFooter:!0,showColumnFooter:!0,enableSorting:!0,enableFiltering:!0,enableGridMenu:!0,exporterCsvFilename:"LRAR analysis.csv",exporterExcelFilename:"LRAR analysis.xlsx",exporterExcelSheetName:"LRAR analysis",exporterPdfDefaultStyle:{fontSize:8},exporterPdfTableStyle:{margin:[10,10,10,10]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"blue"},exporterPdfHeader:{text:"LRAR analysis",style:"headerStyle"},exporterPdfFooter:function(n,t){return{text:n.toString()+" of "+t.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(n){return n.styles.headerStyle={fontSize:22,bold:!0},n.styles.footerStyle={fontSize:10,bold:!0},n},exporterPdfOrientation:"landscape",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:600,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),columnDefs:[{field:"Name",width:150},{field:"Start",width:150,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]},{field:"End",width:150,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]},{field:"Size",aggregationType:r.aggregationTypes.sum,width:150,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]},{field:"Count",displayName:"Count Of Windows",aggregationType:r.aggregationTypes.sum,width:75,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]},{field:"Product",footerCellFilter:"number:2",aggregationType:r.aggregationTypes.avg,width:75,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]},{field:"Substrate",footerCellFilter:"number:2",aggregationType:r.aggregationTypes.avg,width:75,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]},{field:"Composite",footerCellFilter:"number:2",aggregationType:r.aggregationTypes.avg,width:75,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]},{field:"GCContent",footerCellFilter:"number:2",displayName:"GC Content",aggregationType:r.aggregationTypes.avg,width:75,type:"number",filters:[{condition:r.filter.GREATER_THAN,placeholder:">"},{condition:r.filter.LESS_THAN,placeholder:"<"}]}],onRegisterApi:function(){}};n.update=function(){u()}}angular.module("app").controller("lrarCtrl",n);n.$inject=["$scope","$routeParams","lrarFactory","uiGridConstants"]}(),function(){"use strict";function n(n,t,i,r,u,f,e){function h(){n.loadingRIP=!0;n.IsSequence=r.SequenceName!==undefined;n.IsFile=r.FileName!==undefined;n.IsSequence?(n.SequenceName=r.SequenceName,t.RIPSequence(r.FileName,n.SequenceName,n.window,n.slide).then(t=>{n.ripGridOptions.data=t,n.ripData=t,n.seqNames=t.map(n=>n.SequenceName),n.seqNamesUnique=c(n.seqNames),o(n.startRange,n.endRange),n.selectedSequence=n.seqNamesUnique[0],n.updateRange(n.startRange,n.endRange),a(t),n.loadingRIP=!1}),i.GCContentSingleSequenceTotal(r.FileName,n.SequenceName).then(t=>{n.GCContent=Number.parseFloat(t).toFixed(2),l()})):n.IsFile&&(n.FileName=r.FileName,t.RIPFile(n.FileName,n.window,n.slide).then(function(t){n.ripGridOptions.data=t;n.ripData=t;n.seqNames=t.map(n=>n.SequenceName);n.seqNamesUnique=c(n.seqNames);o(n.startRange,n.endRange);a(n.ripData);i.GCContentFileTotal(n.FileName).then(t=>{n.GCContent=Number.parseFloat(t).toFixed(2),l(),n.loadingRIP=!1})}))}function c(n){for(var i={},r=[],t=0,u=n.length;t<u;++t)i.hasOwnProperty(n[t])||(r.push(n[t]),i[n[t]]=1);return r}function s(){n.RIPPie.data=[];n.RIPPie.data.push(n.RIPPercentage);n.RIPPie.data.push(100-n.RIPPercentage);n.RIPPie.labels=["Total RIP %","Non Rip"];n.RIPPie.colors=["#46bf50","#e0e0e0"];n.RIPPie.series=["Series"]}function l(){n.GCContentChart.data=[];n.GCContentChart.data.push(n.GCContent);n.GCContentChart.data.push(100-n.GCContent);n.GCContentChart.labels=["Total GC Content %","Non GC"];n.GCContentChart.colors=["#ffc107","#e0e0e0"];n.GCContentChart.series=["Series"]}function o(t,i){let r=n.ripData.filter(r=>r.SequenceName===n.selectedSequence&&r.Start>=t&&r.End<=i);n.ripIndex.Start=r.map(n=>n.Start);n.ripIndex.Product=r.map(n=>n.Product);n.ripIndex.Substrate=r.map(n=>n.Substrate);n.ripIndex.Composite=r.map(n=>n.Composite);n.ripIndex.data=[];n.ripIndex.data.push(n.ripIndex.Product);n.ripIndex.data.push(n.ripIndex.Substrate);n.ripIndex.data.push(n.ripIndex.Composite);n.ripIndex.series=["Product","Substrate","Composite"];n.ripIndex.colors=["#46bf50","#fddf5c","#e26253"];n.ripIndex.options={scales:{yAxes:[{id:"y-axis-1",type:"linear",display:!0,position:"left"}]},legend:{display:!0},title:{display:!0,text:"RIP Index"},tooltips:{mode:"index",intersect:!1},hover:{mode:"nearest",intersect:!0}};f(function(){let n=document.getElementById("aDownloadLink");var t=document.getElementById("line");n.download="RIPChart.png";n.href=t.toDataURL("image/png").replace("image/png","image/octet-stream");document.getElementsByClassName("ui-grid-menu-button")[0].setAttribute("title","Download results, and hide columns")},3e3)}function a(t){if(n.checkGcContent===!0&&n.IsSequence!==!0)e.get("api/rip/file/RIPTotalPercentageWithGcContentValidityTest/"+r.FileName+"/"+n.compositeRequirement+"/"+n.productRequirement+"/"+n.substrateRequirement+"/"+n.window+"/"+n.slide+"").then(function(t){n.RIPPercentage=parseFloat(t.data).toFixed(2);s()}),s();else if(n.checkGcContent===!0){let i=t.length,r=t.filter(t=>t.Product>=n.productRequirement&&t.Composite>=n.compositeRequirement&&t.Substrate<=n.substrateRequirement&&t.GCContent<n.GCContent).length,u=r/i*100;n.RIPPercentage=u.toFixed(2);s()}else{let i=t.length,r=t.filter(t=>t.Product>=n.productRequirement&&t.Substrate<=n.substrateRequirement&&t.Composite>=n.compositeRequirement).length,u=r/i*100;n.RIPPercentage=u.toFixed(2);s()}}n.title="ripCtrl";n.ripIndex={};n.startRange=0;n.endRange=1e5;n.selectedSequence="";n.loadingRIP=!0;n.RIPPie={};n.GCContentChart={};n.window=1e3;n.slide=500;n.compositeRequirement=.01;n.productRequirement=1.1;n.substrateRequirement=.75;n.ripGridOptions={multiSelect:!1,enableSorting:!0,showGridFooter:!0,showColumnFooter:!0,enableFiltering:!0,enableGridMenu:!0,exporterCsvFilename:"RIPAnalysis.csv",exporterExcelFilename:"RIPAnalysis.xlsx",exporterExcelSheetName:"RIPAnalysis",exporterPdfDefaultStyle:{fontSize:8},exporterPdfTableStyle:{margin:[10,10,10,10]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"blue"},exporterPdfHeader:{text:"RIP Analysis Report",style:"headerStyle"},exporterPdfFooter:function(n,t){return{text:n.toString()+" of "+t.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(n){return n.styles.headerStyle={fontSize:22,bold:!0},n.styles.footerStyle={fontSize:10,bold:!0},n},exporterPdfOrientation:"landscape",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:600,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),columnDefs:[{field:"SequenceName",width:270},{field:"Start",width:80,type:"number",filters:[{condition:u.filter.GREATER_THAN,placeholder:">"},{condition:u.filter.LESS_THAN,placeholder:"<"}]},{field:"End",width:80,type:"number",filters:[{condition:u.filter.GREATER_THAN,placeholder:">"},{condition:u.filter.LESS_THAN,placeholder:"<"}]},{field:"Product",type:"number",footerCellFilter:"number:2",aggregationType:u.aggregationTypes.avg,width:120,filters:[{condition:u.filter.GREATER_THAN,placeholder:">"},{condition:u.filter.LESS_THAN,placeholder:"<"}]},{field:"Substrate",type:"number",footerCellFilter:"number:2",aggregationType:u.aggregationTypes.avg,width:120,filters:[{condition:u.filter.GREATER_THAN,placeholder:">"},{condition:u.filter.LESS_THAN,placeholder:"<"}]},{field:"Composite",type:"number",footerCellFilter:"number:2",aggregationType:u.aggregationTypes.avg,width:120,filters:[{condition:u.filter.GREATER_THAN,placeholder:">"},{condition:u.filter.LESS_THAN,placeholder:"<"}]},{field:"GCContent",type:"number",footerCellFilter:"number:2",displayName:"GC Content",aggregationType:u.aggregationTypes.avg,width:120,filters:[{condition:u.filter.GREATER_THAN,placeholder:">"},{condition:u.filter.LESS_THAN,placeholder:"<"}]}],onRegisterApi:function(){}};h();n.UpdateWindowAndSlide=function(){h()};n.selectSequence=function(t){n.selectedSequence=t;o(n.startRange,n.endRange)};n.slideRange=function(t){if(t==="forward"){let t=n.endRange-n.startRange;n.startRange=n.startRange+t/2;n.endRange=n.endRange+t/2;o(n.startRange,n.endRange);let i=document.getElementById("aDownloadLink"),r=document.getElementById("line");i.download="RIPChart.png";i.href=r.toDataURL("image/png").replace("image/png","image/octet-stream")}else if(t==="backward"){let t=n.endRange-n.startRange;n.startRange=n.startRange-t/2;n.endRange=n.endRange-t/2;o(n.startRange,n.endRange);let i=document.getElementById("aDownloadLink"),r=document.getElementById("line");i.download="RIPChart.png";i.href=r.toDataURL("image/png").replace("image/png","image/octet-stream")}};n.updateRange=function(n,t){o(n,t)};n.saveLineChart=function(){var n=document.getElementById("line");document.location.href=n.toDataURL("image/png").replace("image/png","image/octet-stream")}}angular.module("app").controller("ripCtrl",n);n.$inject=["$scope","ripFactory","gcContentFactory","$routeParams","uiGridConstants","$timeout","$http"]}(),function(){"use strict";function n(n,t,i){function r(){n.ripProfileLoading=!0;n.FileName=t.FileName;n.SequenceId=t.SequenceId;n.FileName!==undefined&&i.getFileProfile(n.FileName,n.window,n.slide,n.compositeRequirement,n.productRequirement,n.substrateRequirement,n.compositeCountRequirement,n.checkGcContent).then(function(t){n.profile=t;let i=[];i.push(t);n.ripProfileGridOptions.data=i;n.ripProfileLoading=!1})}n.title="ripProfileCtrl";n.ripProfileLoading=!0;n.window=1e3;n.slide=500;n.compositeRequirement=.01;n.productRequirement=1.1;n.substrateRequirement=.75;n.compositeCountRequirement=7;r();n.ripProfileGridOptions={multiSelect:!1,enableSorting:!0,enableFiltering:!0,enableGridMenu:!0,exporterCsvFilename:"RIPProfile.csv",exporterExcelFilename:"RIPProfile.xlsx",exporterExcelSheetName:"RIPProfile",exporterPdfDefaultStyle:{fontSize:8},exporterPdfTableStyle:{margin:[10,10,10,10]},exporterPdfTableHeaderStyle:{fontSize:10,bold:!0,italics:!0,color:"blue"},exporterPdfHeader:{text:"RIP Profile Report",style:"headerStyle"},exporterPdfFooter:function(n,t){return{text:n.toString()+" of "+t.toString(),style:"footerStyle"}},exporterPdfCustomFormatter:function(n){return n.styles.headerStyle={fontSize:22,bold:!0},n.styles.footerStyle={fontSize:10,bold:!0},n},exporterPdfOrientation:"landscape",exporterPdfPageSize:"LETTER",exporterPdfMaxGridWidth:600,exporterCsvLinkElement:angular.element(document.querySelectorAll(".custom-csv-link-location")),columnDefs:[{field:"Count",width:150},{field:"FileBP",width:150},{field:"ProductAverage",width:150},{field:"SubstrateAverage",width:150},{field:"CompositeAverage",width:150},{field:"SumOfLRAR",width:150},{field:"EstimatedGenomeRIP",width:150},{field:"SumAverage",width:150}],onRegisterApi:function(){}};n.exportProfileAsCSV=function(){var i=n.profile,t="data:text/csv;charset=utf-8,",u,r;t=t+"Name,"+i.FileName+"\r\n";t=t+"Genome Size (bp),"+i.FileBP+"\r\n";t=t+"Count of Genomic Windows Investigated,"+i.WindowsInvestigated+"\r\n";t=t+"GC Content of Genome Assembly (%),"+i.TotalGCContent+"\r\n";t=t+"Number of RIP Affected Windows,"+i.RIPPositiveWindows+"\r\n";t=t+"RIP Affected Genomic Proportion (%),"+i.EstimatedGenomeRIP+"\r\n";t=t+"Count of LRARs,"+i.Count+"\r\n";t=t+"Average Size of LRARs (bp),"+i.SumAverage+"\r\n";t=t+"Average GC Content of LRARs (%),"+i.LRARAverageGCContent+"\r\n";t=t+"Genomic Proportion of LRARs (bp),"+i.SumOfLRAR+"\r\n";t=t+"Product Value for LRARs,"+i.ProductAverage+"\r\n";t=t+"Substrate Value for LRARs,"+i.SubstrateAverage+"\r\n";t=t+"Composite Value for LRARs,"+i.CompositeAverage;u=encodeURI(t);r=document.createElement("a");r.setAttribute("href",u);r.setAttribute("download",i.FileName+"_profile.csv");r.innerHTML="Click Here to download";document.body.appendChild(r);r.click()};n.update=function(){r()}}angular.module("app").controller("ripProfileCtrl",n);n.$inject=["$scope","$routeParams","ripProfileFactory"]}(),function(){"use strict";function n(n,t,i){function r(){i.list(n.FileName).then(t=>{n.sequences=t,n.loadingSequences=!1})}n.title="sequenceCtrl";n.FileName=t.FileName;n.loadingSequences=!0;r()}angular.module("app").controller("sequenceCtrl",n);n.$inject=["$scope","$routeParams","sequenceFactory"]}(),function(){"use strict";function n(n){function t(){return n({method:"GET",url:"api/files/list",headers:{"Content-Type":"application/json"}}).then(function(n){return n}).then(function(n){return JSON.parse(n.data).files})}return{list:t}}angular.module("app").factory("fileFactory",n);n.$inject=["$http"]}(),function(){"use strict";function n(n){function t(t,i){return n.get("api/gccontent/sequence/"+t+"/"+i).then(function(n){return n}).then(function(n){return n.data})}function i(t){return n.get("api/gccontent/file/"+t).then(function(n){return n}).then(function(n){return n.data})}return{GCContentSingleSequenceTotal:t,GCContentFileTotal:i}}angular.module("app").factory("gcContentFactory",n);n.$inject=["$http"]}(),function(){"use strict";function n(n){function t(t,i,r,u,f,e,o,s,h){return n.get("api/rip/lrar/sequence/"+t+"/"+i+"/"+r+"/"+u+"/"+f+"/"+e+"/"+o+"/"+s+"/"+h).then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}function i(t,i,r,u,f,e,o,s){return n.get("api/rip/lrar/file/"+t+"/"+i+"/"+r+"/"+u+"/"+f+"/"+e+"/"+o+"/"+s).then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}return{getSequence:t,getFile:i}}angular.module("app").factory("lrarFactory",n);n.$inject=["$http"]}(),function(){"use strict";function n(n){function t(){return n.get("/api/rip").then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}function i(t){return n.get("api/rip/indexes/"+t).then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}function r(t,i,r,u){return r!==undefined&&u!==undefined?n.get("/api/rip/sequence/"+t+"/"+i+"/"+r+"/"+u).then(function(n){return n}).then(function(n){return JSON.parse(n.data)}):n.get("/api/rip/sequence/"+t+"/"+i).then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}function u(t,i,r){return i!==undefined&&r!==undefined?n.get("/api/rip/file/"+t+"/"+i+"/"+r).then(function(n){return n}).then(function(n){return JSON.parse(n.data)}):n.get("api/rip/file/"+t).then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}return{test:t,RIPIndexes:i,RIPSequence:r,RIPFile:u}}angular.module("app").factory("ripFactory",n);n.$inject=["$http"]}(),function(){"use strict";function n(n){function t(t,i,r,u,f,e,o,s){return n.get("api/rip/profile/file/"+t+"/"+i+"/"+r+"/"+u+"/"+f+"/"+e+"/"+o+"/"+s).then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}return{getFileProfile:t}}angular.module("app").factory("ripProfileFactory",n);n.$inject=["$http"]}(),function(){"use strict";function n(n){function t(t){return n.get("/api/sequence/"+t).then(function(n){return n}).then(function(n){return JSON.parse(n.data)})}return{list:t}}angular.module("app").factory("sequenceFactory",n);n.$inject=["$http"]}();